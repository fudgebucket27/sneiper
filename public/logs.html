<!DOCTYPE html>
<html>
<head>
    <title>Sneiper Logs</title>
</head>
<body>
    <div id="logOutput"></div>
    <script>
        async function fetchLogs() {
            try {
                const cacheBuster = new Date().getTime();
                const response = await fetch(`/logs?_=${cacheBuster}`);
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                const text = await response.text(); // First get the response as text
                if (!text) {
                    console.log('No logs to display.');
                    return; // Early return if the response is empty
                }
                const logs = JSON.parse(text); // Then parse the text as JSON
                if (!Array.isArray(logs)) {
                    throw new Error('Expected logs to be an array');
                }
                const logDiv = document.getElementById('logOutput');
                logDiv.innerHTML = ''; // Clear existing log entries
                logs.forEach(log => {
                    const logEntry = document.createElement('div');
                    logEntry.textContent = log;
                    logDiv.appendChild(logEntry);
                });
            } catch (error) {
                console.error('Failed to fetch logs:', error);
                const logDiv = document.getElementById('logOutput');
                logDiv.innerHTML = `<div>Error fetching logs: ${error.message}</div>`;
            }
        }
        setInterval(fetchLogs, 1000); // Fetch logs every second
    </script>
</body>
</html>
